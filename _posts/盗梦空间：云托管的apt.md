
---
title: 云托管的apt
date: 2018-10-06 16:07:40
categories:
- 网安组
tags:
- 网络安全
---

### 背景
&emsp;&emsp;Blue CoatLabs的研究人员已经确定了以前未记录的攻击框架的出现，该框架被用于发起高度针对性的攻击，以便从受害者的计算机中获取并从中提取机密信息。由于恶意软件设计中使用了很多层，我们将其命名为Inception--这是对2010年电影“Inception”的一个参考，该电影讲述了一个进入人们梦想并从潜意识中窃取秘密的小偷。目标包括担任战略职位的人员：石油，金融和工程等重要企业的高管，军官，大使馆人员和政府官员。初始攻击始于关注主要位于俄罗斯或与俄罗斯利益相关的目标，但后来扩散到世界其他地方的目标。
<!-- more -->

### 现象
&emsp;&emsp;使用的shellcode是一个非常标准的变体，以前通常在中国境外运营的一些活动使用，但有一些小的变化。恶意内容以编码形式存储在文档中，shellcode将其解码并写入磁盘

&emsp;&emsp;成功执行后，此代码将删除Word文档和Visual Basic脚本。 Word文档显示给用户，以避免在后台执行脚本时引起任何怀疑。



### 原理
&emsp;&emsp;最初的恶意软件组件嵌入在RTF格式（RTF）文件中。利用此文件格式的漏洞利用远程访问受害者的计算机。
。

### 危害
&emsp;&emsp;该框架以这样的方式设计，即可以通过云服务执行所有感染后通信（即目标调查，配置更新，恶意软件更新和数据泄漏）。此框架的恶意软件组件遵循插件模型，其中新的恶意软件依赖于其他先前提供的恶意软件组件来与框架交互。

### 攻击复现

在Blue Coat观察到的所有情况下，初始恶意软件组件都嵌入在RTF格式（RTF）文件中。利用此文件格式的漏洞利用远程访问受害者的计算机。这些文件通过附带利用的Word文档的网络钓鱼电子邮件传递给受害者。

![](https://www.symantec.com/connect/sites/default/files/users/user-4223931/Email%20sample.png)

网络钓鱼电子邮件示例

![](https://www.symantec.com/connect/sites/default/files/users/user-4223931/Bueaty%20Queen.png)

当用户点击附件时，显示Word文档以避免引起用户的怀疑，同时以编码形式存储在文档内的恶意内容写入其磁盘。对于许多漏洞利用广告系列而言不同寻常，丢弃文件的名称各不相同，并且已经明确随机化，以避免按名称进行检测。

恶意软件从受感染的计算机收集系统信息，包括操作系统版本，计算机名称，用户名，用户组成员身份，运行的进程，区域设置ID以及系统驱动器和卷信息。所有这些系统信息都经过加密并通过WebDAV发送到云存储。该框架的设计使得恶意软件感染后的所有通信（即目标调查，配置更新，恶意软件更新和数据泄漏）都可以通过云服务执行。

此框架的恶意软件组件遵循插件模型，新的恶意软件依赖已有的恶意软件组件与框架进行交互。如果没有初始安装程序，则后续的单独模块都不会起作用，并且大多数模块仅存在于内存中 - 在重新启动时消失。

![](https://www.symantec.com/connect/sites/default/files/users/user-4223931/bcs-wp-inception-Malware-Installation-Chain-diagram.jpg)

攻击者已经扩大了他们的努力，包括Android，BlackBerry和iOS设备的恶意软件。

这些用于收集受害者的信息，包括电话录音。特别是在Android平台上，他们正在记录定期上传给攻击者的MP4声音文件的来电和拨出电话。

与此同时，有迹象表明大规模MMS网络钓鱼活动可能针对选定的个人。根据Blue Coat研究人员获得的数据，目标受害者可能是许多移动运营商的客户 - 我们知道有60多家移动运营商受到影响，但实际数字可能要高得多。MMS网络钓鱼消息是为亚洲（包括俄罗斯领域和中国），非洲，中东和欧洲的多个国家准备的。

### 结论
预防感染的方法

- 保持软件更新
- 不要越狱手机 
- 不要从非官方来源安装应用程序

